# `kubeadm`

- `kubeadm` is a tool for bootstrapping a Kubernetes cluster.  
- Used to initialize the control plane and join worker nodes to the cluster.  

## Comprehensive list of `kubeadm` commands

### `kubeadm config`

Manages the `kubeadm` configuration file.

#### Subcommand: `kubeadm config generate`

`InitConfiguration` file:

```bash
kubeadm config generate > init-config.yaml
```

`ClusterConfiguration` file:

```bash
kubeadm config generate > cluster-config.yaml
```

#### Subcommand: `kubeadm config print`

- Shows default static configuration.

```bash
kubeadm config print init-defaults
```

```bash
kubeadm config print join-defaults
```

```bash
kubeadm config print subcommand <subcommand>
```

`<command>` can be: `token-generate`, `token-expire`, or `token-flush`.

#### Subcommand: `kubeadm config images`

- Manages container images.

```bash
kubeadm config images list
```

```bash
kubeadm config images pull
```

#### Subcommand: `kubeadm config migrate`

- The `kubeadm` config migrate command is used to convert old `kubeadm` configuration files to a newer, supported API version.

```bash
kubeadm config migrate config.yaml > config-new.yaml
```

> This will migrate and create a new file.

### `kubeadm init`

Initializes a Kubernetes cluster. This command will create the necessary control plane components and configure the kubelet on the local node to join the cluster.

> Requires both init and cluster config files.

```bash
kubeadm init --config init-config.yaml --config cluster-config.yaml
```

### `kubeadm join`

Joins a worker node to an existing Kubernetes cluster.

```bash
kubeadm join <token>
```

Where `<token>` is the join token generated by the kubeadm init command.

#### `join` Flags

- The `--control-plane` flag is optional and is only needed if you are joining a worker node to a cluster that has multiple control plane nodes.  
- The `--token-discovery` flag tells `kubeadm` to discover the join token from the control plane node. This is useful if you do not have the join token available.  
- The `--skip-preflight-checks` flag tells `kubeadm` to skip the preflight checks. This is useful if you want to skip the checks to quickly join a worker node to a cluster.  
- The `--ignore-preflight-errors` flag tells `kubeadm` to ignore any preflight errors. This is useful if you know that the preflight checks will fail but you want to try to join the worker node to the cluster anyway.

### `kubeadm upgrade`

Resets a Kubernetes cluster to its initial state. This command will delete all control plane components and worker nodes from the cluster.

```bash
kubeadm upgrade <version>
```

You can also upgrade the kubelet on specific nodes by providing a list of node names:

```bash
kubeadm upgrade node node1 node2
```

#### `upgrade` Flags

- The `--image-repository` flag specifies the repository from which to pull the container images.  
- The `--image-tag` flag specifies the tag of the container images to pull.  
- The `--dry-run` flag tells `kubeadm` to perform a dry run of the upgrade. This will not make any changes to the cluster, but it will print a list of the changes that would be made.  
- The `--skip-preflight-checks` flag tells `kubeadm` to skip the preflight checks. This is useful if you want to skip the checks to quickly upgrade a cluster.  
- The `--ignore-preflight-errors` flag tells `kubeadm` to ignore any preflight errors. This is useful if you know that the preflight checks will fail but you want to try to upgrade the cluster anyway.  

### `kubeadm alpha`

Provides access to experimental `kubeadm` features. These features are not yet stable and may not be available in future releases of `kubeadm`.

```bash
kubeadm alpha <command>
```

#### Subcommand: `kubeadm alpha taint nodes`

- A command that allows you to taint nodes in your Kubernetes cluster.  
- Taints are a way to mark nodes as undesirable for certain pods.  
- Pods that have a toleration for a taint will still be scheduled onto the node, but pods that do not have a toleration for the taint will not be scheduled onto the node.

The `kubeadm alpha taint nodes` command takes two arguments:

- The name of the node to taint and the taint to apply
- The taint is specified as a `key=value` pair.
- The key is the name of the taint, and the value is the value of the taint

The effect of the taint can be one of the following:

`NoSchedule`: Prevents pods from being scheduled onto the node.  
`NoExecute`: Prevents pods from being executed on the node.  
`PreferNoSchedule`: Prefers to schedule pods onto other nodes, but will schedule pods onto the node if no other nodes are available.

```bash
kubeadm alpha taint nodes node1 key1=value1:NoSchedule
```

### `kubeadm certs`

Manages the Kubernetes cluster certificates. This command can be used to print the certificates, generate new certificates, or rotate the certificates.

```bash
kubeadm certs print
```

```bash
kubeadm certs generate
```

```bash
kubeadm certs renew
```

### `kubeadm kubeconfig`

Manages the kubeconfig file. This file is used to configure kubectl to communicate with a Kubernetes cluster.

```bash
kubeadm kubeconfig print
```

```bash
kubeadm kubeconfig view
```
